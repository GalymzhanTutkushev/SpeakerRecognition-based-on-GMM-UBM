function Fton = pitchByCep(y0,Fs)
y = y0;
DI=0;
%=====================================
% y - ????????????? ??????? ??????
% Fs - ??????? ????????????? ???????? ???????
%=====================================
Fton = 0; % ??????? ????????? ????
 
% y=y-mean(y); % ????????????? ???????
 
L=length(y); % ????? ??????? ????
 
% ===== ?????????? ??????? ??????? ????????=========
window = hamming(L); 
y=y.*window;

% ===== ??? ???????? ??????? ========
% NFFT=2048; 
NFFT = 1024;
y(NFFT)=0;
YA=fft(y,NFFT);
% ===================================
 
A=2*abs(YA); % ???????? ???????????? ???
log_magn = log(A); % ??????????? ???????? ???????? ???????????? ???
cep = ifft(log_magn); % ?????? ???????? ???????
 
% =========== ????? ???????? ?????? ????????? ========
MinN=fix(Fs/400); 
MaxN=fix(Fs/60);
 
% ==== ????? ????????????? ???????? ??????? ? ????????????? ???????? ===
maxC=0;
for I=MinN:MaxN
    if maxC<cep(I) && cep(I)>=cep(I-1) && cep(I)>=cep(I+1)
      maxI=I;
      maxC=cep(I);
    end;
    if maxC>=0.1 % ????????? ? ????????? ?????????
      break;
    end;
end;
  
if maxC>=0.1
    DI=maxI; % ????? ????????, ???????????????? ??????? ????????? ????
else
    return;
end;
 
  Fton = Fs/DI; % ??????? ????????? ????
end